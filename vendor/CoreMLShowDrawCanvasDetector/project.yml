name: CoreMLShowDrawCanvasDetector
options:
  bundleIdPrefix: tokyo.kaito.showdraw.canvas-detector-coreml
  deploymentTarget:
    macOS: "14.0"

settings:
  base:
    ASSETCATALOG_COMPILER_GENERATE_SWIFT_ASSET_SYMBOL_EXTENSIONS: YES
    DEAD_CODE_STRIPPING: YES
    ENABLE_MODULE_VERIFIER: YES
    ENABLE_USER_SCRIPT_SANDBOXING: YES
    GENERATE_INFOPLIST_FILE: YES
    MODULE_VERIFIER_SUPPORTED_LANGUAGE_STANDARDS: gnu11 gnu++14

targets:
  CoreMLShowDrawCanvasDetector:
    type: framework
    platform: macOS
    sources:
      - path: Sources/
        headers:
          public:
            - CoreMLShowDrawCanvasDetector.h 
            - ShowDrawCanvasDetectorWrapper.h
            - ShowDrawCanvasDetectorResult.h
    dependencies:
      - sdk: CoreML.framework
      - sdk: Vision.framework
    settings:
      base:
        PRODUCT_BUNDLE_IDENTIFIER: tokyo.kaito.showdraw.canvas-detector-coreml
      configs:
        Debug:
          CODE_SIGN_STYLE: Automatic
        Release:
          CODE_SIGN_STYLE: Automatic

  CoreMLShowDrawCanvasDetectorTests:
    type: bundle.unit-test
    platform: macOS
    sources:
      - path: Tests/
    dependencies:
      - target: CoreMLShowDrawCanvasDetector
      - sdk: Vision.framework
      - sdk: AppKit.framework
      - sdk: CoreImage.framework
    settings:
      base:
        PRODUCT_BUNDLE_IDENTIFIER: tokyo.kaito.showdraw.canvas-detector-coreml-tests
        CODE_SIGN_STYLE: Manual
        CODE_SIGN_IDENTITY: "-"

schemes:
  CoreMLShowDrawCanvasDetector:
    build:
      targets:
        CoreMLShowDrawCanvasDetector: all
        CoreMLShowDrawCanvasDetectorTests: testing
    test:
      config: Debug
      targets:
        - CoreMLShowDrawCanvasDetectorTests
